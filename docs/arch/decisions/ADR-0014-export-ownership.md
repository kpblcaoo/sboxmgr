# ADR-0014: Export Ownership and CLI Structure

## Status
Accepted

## Context

- В проекте используется централизованный CLI-интерфейс `sboxctl` (реализован в sboxmgr).
- Команда `export` уже зарезервирована и используется в sboxctl по назначению.
- В sboxagent ранее были попытки реализовать экспорт как CLI-команду и/или модуль, что привело к дублированию и конфликтам.
- Логика экспорта (особенно JSON-экспорт) должна быть доступна как для CLI, так и для агента, но без дублирования кода и UI.

## Decision

- **CLI-интерфейс (sboxctl) — централизованный.**
    - Вся CLI-логика, связанная с экспортом, реализуется только в sboxmgr (sboxctl).
    - Агент (sboxagent) не реализует собственный UI/CLI для экспорта.
- **Имя export в sboxctl — уже занято и используется по назначению.**
    - sboxagent не должен дублировать это имя ни как модуль, ни как CLI-команду.
- **Логика JSON-экспорта выносится в sbox-common.**
    - sboxmgr вызывает её из sboxctl export.
    - sboxagent использует её через internal API (импорт как библиотеку, не через CLI).

## Consequences

- В sboxagent:
    - ❌ Не должно быть cli/commands/export.py
    - ❌ Не должно быть export/ как пакета
    - ✅ Может быть модуль json_exporter.py, но только если он находится в sbox-common
    - ✅ Агент вызывает json_exporter как библиотеку, а не через CLI
- Вся CLI-логика экспорта и пользовательский интерфейс — только в sboxmgr (sboxctl).
- Дублирование и конфликты исключены, архитектура становится прозрачной и поддерживаемой.

## Motivation

- Централизация CLI-интерфейса снижает путаницу для пользователя и разработчика.
- Разделение UI и внутренней логики повышает переиспользуемость и тестируемость.
- sbox-common становится единой точкой для кросс-языковых и кросс-проектных утилит.

---

_Принято на основании анализа структуры sboxctl, sboxmgr и sboxagent, а также обсуждения архитектурных конфликтов экспорта._ 