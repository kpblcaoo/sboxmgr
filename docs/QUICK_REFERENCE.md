# sboxmgr Quick Reference Card

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ü—Ä–æ—Å—Ç–∞—è –∫–æ–º–∞–Ω–¥–∞
python -m sboxmgr.cli export --inbound-types tun

# –° –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
python -m sboxmgr.cli export \
  --url "$SUB_URL" \
  --inbound-types tun,socks \
  --socks-auth user:pass \
  --postprocessors geo_filter
```

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------|------------|
| CLI Entry | `cli/commands/export.py` | –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–º–∞–Ω–¥, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è |
| InboundBuilder | `cli/inbound_builder.py` | –°–æ–∑–¥–∞–Ω–∏–µ ClientProfile –∏–∑ CLI |
| Fetchers | `subscription/fetchers/` | –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ (URL/File/API) |
| Parsers | `subscription/parsers/` | –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–æ—Ä–º–∞—Ç–æ–≤ (YAML/JSON/base64) |
| Middleware | `subscription/middleware/` | –û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| Postprocessors | `subscription/postprocessors/` | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ |
| Exporters | `subscription/exporters/` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è sing-box –∫–æ–Ω—Ñ–∏–≥–∞ |
| Policies | `policies/` | –ü–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
CLI ‚Üí InboundBuilder ‚Üí Fetcher ‚Üí Parser ‚Üí Middleware ‚Üí Postprocessors ‚Üí Exporter ‚Üí Output
```

## üìù –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### Inbound Types
- `tun` - TUN –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Å–∏—Å—Ç–µ–º–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è)
- `socks` - SOCKS5 –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä
- `http` - HTTP –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä
- `tproxy` - Transparent proxy (Linux)

### Postprocessors
- `geo_filter` - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∞–º
- `tag_filter` - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–≥–∞–º
- `latency_sort` - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–∏–Ω–≥—É
- `duplicate_removal` - –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

### Middleware
- `logging` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
- `enrichment` - –û–±–æ–≥–∞—â–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

- SOCKS/HTTP: bind –Ω–∞ `127.0.0.1`
- –ü–æ—Ä—Ç—ã: —Ç–æ–ª—å–∫–æ unprivileged (1024-65535)
- TPROXY: bind –Ω–∞ `0.0.0.0` (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏)
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –≤–Ω–µ—à–Ω–µ–º bind

## üîß –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

### –î–æ–º–∞—à–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
```bash
--inbound-types tun
```

### –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫
```bash
--inbound-types socks,http \
--socks-port 1080 \
--http-port 8080
```

### –°–µ—Ä–≤–µ—Ä
```bash
--inbound-types socks,http,tproxy \
--socks-listen "0.0.0.0" \
--socks-auth admin:password \
--http-listen "0.0.0.0" \
--postprocessors geo_filter
```

## üö® –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**Q: –°–µ—Ä–≤–µ—Ä—ã –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è**
```bash
# –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
--middleware logging
```

**Q: –ù—É–∂–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è**
```bash
# –ò—Å–∫–ª—é—á–∏—Ç—å —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ —Å–µ—Ä–≤–µ—Ä—ã
--postprocessors geo_filter
```

**Q: –û—à–∏–±–∫–∞ bind permission**
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å unprivileged –ø–æ—Ä—Ç—ã
--socks-port 1080  # –Ω–µ 80
```

**Q: –í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–∫—Å–∏**
```bash
# –Ø–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å bind –Ω–∞ –≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
--socks-listen "0.0.0.0"
```

## üìä –û—Ç–ª–∞–¥–∫–∞

```bash
# –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
--middleware logging --debug 2

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
--dry-run

# –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
sing-box check -c output.json
```

## üéØ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

1. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - secure by default
3. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã/–ø—Ä–æ—Ç–æ–∫–æ–ª—ã
4. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –ø—Ä–æ—Ñ–∏–ª—è–º–∏
5. **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ 