# SBoxMgr - –ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π Sing-box

[![Build Status](https://github.com/kpblcaoo/update-singbox/actions/workflows/ci-dev.yml/badge.svg)](https://github.com/kpblcaoo/update-singbox/actions)
[![Tests](https://img.shields.io/badge/tests-passing-brightgreen)](https://github.com/kpblcaoo/update-singbox/actions)
[![License: MIT](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

Python CLI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ –ø—Ä–æ–∫—Å–∏ [sing-box](https://sing-box.sagernet.org/). –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤, –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—É—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (3 —à–∞–≥–∞)

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
git clone https://github.com/kpblcaoo/update-singbox.git
cd update-singbox
python -m venv .venv
source .venv/bin/activate  # –ù–∞ Windows: .venv\Scripts\activate
pip install .
```

### 2. –ü–æ–ª—É—á–∏—Ç—å URL –ø—Ä–æ–∫—Å–∏
–í–∞–º –Ω—É–∂–µ–Ω URL, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é —Å sing-box –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (Clash, sing-box JSON –∏ —Ç.–¥.). –û–±—ã—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:
- –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É –≤–∞—à–µ–≥–æ VPN –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- URL –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Clash
- –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ sing-box

### 3. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥
```bash
# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
sboxctl list-servers -u "–í–ê–®_URL_–ü–†–û–ö–°–ò_–ó–î–ï–°–¨"

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ #1
sboxctl export -u "–í–ê–®_URL_–ü–†–û–ö–°–ò_–ó–î–ï–°–¨" --index 1

# –ó–∞–ø—É—Å—Ç–∏—Ç—å sing-box —Å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–æ–Ω—Ñ–∏–≥–æ–º
sing-box run -c config.json
```

–í—Å—ë! –í–∞—à sing-box —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º.

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ü—Ä–æ—Å—Ç–æ–π CLI**: –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—á–∏—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤ sing-box
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤**: VLESS, Shadowsocks, VMess, Trojan, TUIC, Hysteria2
- **–£–º–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è**: –ü—Ä—è–º–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤, –ø—Ä–æ–∫—Å–∏ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞–º–∏**: –°–ø–∏—Å–æ–∫, –≤—ã–±–æ—Ä –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤
- **–ì–∏–±–∫–∏–π –≤–≤–æ–¥**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Clash, sing-box JSON –∏ –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
- **–ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É**: 90%+ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏, –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üìñ –û–±—ã—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
sboxctl list-servers -u "https://example.com/proxy.json"

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
sboxctl export -u "https://example.com/proxy.json" --index 2

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ –∏–º–µ–Ω–∏
sboxctl export -u "https://example.com/proxy.json" --remarks "–ë—ã—Å—Ç—Ä—ã–π —Å–µ—Ä–≤–µ—Ä"

# –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥–∞ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (dry-run)
sboxctl export -u "https://example.com/proxy.json" --index 1 --dry-run
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞–º–∏
```bash
# –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–Ω–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è)
sboxctl exclusions -u "https://example.com/proxy.json" --add 3

# –£–¥–∞–ª–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –∏–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
sboxctl exclusions -u "https://example.com/proxy.json" --remove 3

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
sboxctl exclusions --view

# –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
sboxctl clear-exclusions
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```bash
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π inbound (SOCKS –ø—Ä–æ–∫—Å–∏ –Ω–∞ –ø–æ—Ä—Ç—É 1080)
sboxctl export -u "https://example.com/proxy.json" --index 1 \
  --inbound-types socks --socks-port 1080

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é (–≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏)
sboxctl export -u "https://example.com/proxy.json" --index 1 \
  --final-route proxy

# –ò—Å–∫–ª—é—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã outbound
sboxctl export -u "https://example.com/proxy.json" --index 1 \
  --exclude-outbounds block,dns
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
# –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: ./config.json)
SBOXMGR_CONFIG_FILE=/etc/sing-box/config.json

# –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –ª–æ–≥–æ–≤
SBOXMGR_LOG_FILE=./sboxmgr.log

# –§–∞–π–ª –∏—Å–∫–ª—é—á–µ–Ω–∏–π
SBOXMGR_EXCLUSION_FILE=./exclusions.json

# –Ø–∑—ã–∫ (en, ru, de, zh, –∏ —Ç.–¥.)
SBOXMGR_LANG=ru
```

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- **–í—ã–≤–æ–¥ –∫–æ–Ω—Ñ–∏–≥–∞**: `./config.json` (–∏–ª–∏ `SBOXMGR_CONFIG_FILE`)
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: `./sboxmgr.log` (–∏–ª–∏ `SBOXMGR_LOG_FILE`)
- **–ò—Å–∫–ª—é—á–µ–Ω–∏—è**: `./exclusions.json` (–∏–ª–∏ `SBOXMGR_EXCLUSION_FILE`)
- **–Ø–∑—ã–∫**: –ê–Ω–≥–ª–∏–π—Å–∫–∏–π (–∏–ª–∏ `SBOXMGR_LANG`)

## üîß –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –°–∏—Å—Ç–µ–º–∞ –ø–ª–∞–≥–∏–Ω–æ–≤
–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ fetchers, parsers –∏ exporters:

```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω –ø–ª–∞–≥–∏–Ω–∞
sboxctl plugin-template fetcher MyCustomFetcher --output-dir ./plugins/

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π –ø–ª–∞–≥–∏–Ω
sboxctl export -u "custom://my-data" --fetcher my-custom-fetcher
```

### –î–≤–∏–∂–æ–∫ –ø–æ–ª–∏—Ç–∏–∫
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏:

```bash
# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–ª–∏—Ç–∏–∫
sboxctl policy list

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≥–µ–æ-–ø–æ–ª–∏—Ç–∏–∫—É
sboxctl export -u "https://example.com/proxy.json" --index 1 \
  --policy geo-direct
```

### –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —è–∑—ã–∫
sboxctl lang --set ru

# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —è–∑—ã–∫–æ–≤
sboxctl lang
```

## üõ† –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–µ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
pip install -e ".[dev]"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
pytest -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–∏–Ω—Ç–∏–Ω–≥
ruff check src/

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
black src/
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
src/sboxmgr/
‚îú‚îÄ‚îÄ cli/          # –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
‚îú‚îÄ‚îÄ core/         # –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ subscription/ # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
‚îú‚îÄ‚îÄ export/       # –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
‚îú‚îÄ‚îÄ models/       # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ i18n/         # –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è
‚îî‚îÄ‚îÄ utils/        # –£—Ç–∏–ª–∏—Ç—ã
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è](user-guide/) - –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- [–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ CLI](user-guide/cli-reference.md) - –ü–æ–ª–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–∞–Ω–¥
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏](getting-started/configuration.md) - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](security.md) - –°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞](developer/) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏
3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã
5. –û—Ç–ø—Ä–∞–≤—å—Ç–µ pull request

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. –≤ LICENSE.

---

**–î—Ä—É–≥–∏–µ —è–∑—ã–∫–∏ / Other languages**
- [English (README.md)](../../README.md) 